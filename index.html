<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Công Cụ Tính Phí Bảo Hiểm AIA</title>
<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
<link href="style.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet"/>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
<div class="container mx-auto p-4 sm:p-6 lg:p-8">
<header class="flex items-center justify-between pb-6 border-b-2 border-red-600 mb-6">
  <img src="https://www.aia.com.vn/content/dam/group-wise/images/system/icons/aia-logo-red.svg" alt="AIA Logo" class="h-8" />
  <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 text-right">Công Cụ Minh Họa Phí Bảo Hiểm</h1>
</header>

<main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
  <div class="lg:col-span-2 space-y-6">

    <!-- Section 1: NĐBH chính -->
    <div id="main-person-container" class="person-container space-y-6 bg-white p-6 rounded-lg shadow-sm border border-gray-200">
      <h2 class="text-xl font-bold text-aia-red mb-4">1. Thông Tin Người Được Bảo Hiểm Chính</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="font-medium block mb-1">Họ và Tên</label>
          <input type="text" class="form-input name-input" placeholder="Nguyễn Văn A">
        </div>
        <div>
          <label class="font-medium block mb-1">Ngày sinh</label>
          <input type="text" class="form-input dob-input" placeholder="DD/MM/YYYY">
        </div>
        <div>
          <label class="font-medium block mb-1">Giới tính</label>
          <select class="form-select gender-select">
            <option value="Nam">Nam</option>
            <option value="Nữ">Nữ</option>
          </select>
        </div>
        <div class="flex items-end">
          <p class="text-lg">Tuổi: <span class="font-bold text-aia-red age-span">0</span></p>
        </div>
        <div class="relative">
          <label class="font-medium block mb-1">Nghề nghiệp</label>
          <input type="text" class="form-input occupation-input" placeholder="Gõ để tìm nghề nghiệp...">
          <div class="occupation-autocomplete hidden absolute z-10 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-60 overflow-y-auto"></div>
        </div>
        <div class="flex items-end">
          <p class="text-lg">Nhóm nghề: <span class="font-bold text-aia-red risk-group-span">...</span></p>
        </div>
      </div>
    </div>

    <!-- Section 2: Sản phẩm chính -->
    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
      <h2 class="text-xl font-bold text-aia-red mb-4">2. Lựa Chọn Sản Phẩm Chính</h2>
      <div>
        <select id="main-product" class="form-select">
          <option value="">-- Chọn sản phẩm chính --</option>
          <option value="PUL_TRON_DOI">PUL Trọn đời</option>
          <option value="PUL_15_NAM">PUL 15 năm</option>
          <option value="PUL_5_NAM">PUL 5 năm</option>
          <option value="KHOE_BINH_AN">MUL - Khoẻ Bình An</option>
          <option value="VUNG_TUONG_LAI">MUL - Vững Tương Lai</option>
          <option value="TRON_TAM_AN">Trọn tâm an</option>
          <option value="AN_BINH_UU_VIET">An Bình Ưu Việt</option>
        </select>
      </div>
      <div id="main-product-options" class="mt-4 space-y-4"></div>
      <div id="main-product-fee-display" class="text-right font-bold text-lg text-aia-red mt-2 min-h-[1.75rem]"></div>
    </div>

    <!-- Section 3: SP bổ sung cho NĐBH chính -->
    <div id="main-supp-container" class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
      <h2 class="text-xl font-bold text-aia-red mb-4">3. Lựa Chọn Sản Phẩm Bổ Sung (Cho NĐBH Chính)</h2>
      <div class="supplementary-products-container space-y-6">
        <!-- JS sẽ render -->
      </div>
    </div>

    <!-- Section 4: NĐBH bổ sung -->
    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-200">
      <h2 class="text-xl font-bold text-aia-red mb-4">4. Người Được Bảo Hiểm Bổ Sung</h2>
      <div id="supplementary-insured-container" class="space-y-6"></div>
      <button id="add-supp-insured-btn" class="mt-4 px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors w-full text-left flex items-center space-x-2">
        <span>+ Thêm Người Được Bảo Hiểm Bổ Sung</span>
      </button>
    </div>

    <!-- Section 5: Miễn Đóng Phí 3.0 -->
    <div id="mdp3-section" class="bg-white p-6 rounded-lg shadow-sm border border-gray-200 hidden">
      <h2 class="text-xl font-bold text-aia-red mb-4">5. Miễn Đóng Phí 3.0 (Bên mua bảo hiểm)</h2>
      <div class="flex items-center space-x-2 mb-3">
        <input type="checkbox" id="mdp3-enable" class="form-checkbox">
        <label for="mdp3-enable" class="text-gray-700 font-medium">
          Miễn đóng phí 3.0
        </label>
      </div>
      <div id="mdp3-radio-list">
        <div id="mdp3-select-container"></div>
      </div>
      <div id="mdp3-fee-display" class="mt-3 text-aia-red font-bold"></div>
    </div>
  </div>

  <!-- Cột kết quả -->
  <div class="lg:col-span-1">
    <div class="bg-white p-6 rounded-lg shadow-sm border-2 border-aia-red sticky top-8">
      
      <!-- SECTION 6: Tóm Tắt Phí Bảo Hiểm -->
      <div id="results-container" class="space-y-3 text-lg">
        <h2 class="text-2xl font-bold text-gray-900 mb-4 text-center">Tóm Tắt Phí Bảo Hiểm</h2>

        <!-- Dòng 1-3: Tổng hợp NĐBH chính -->
        <div id="main-insured-summary" class="space-y-2 mb-3">
          <div class="text-lg font-semibold">Người được bảo hiểm chính: <span id="main-insured-total" class="text-aia-red">0 VNĐ</span></div>
          <div class="text-sm text-gray-600 pl-4">
            <div>Phí sản phẩm chính: <span id="main-insured-main-fee">0 VNĐ</span></div>
            <div>Phí đóng thêm: <span id="main-insured-extra-fee">0 VNĐ</span></div>
            <div>Phí sản phẩm bổ sung: <span id="main-insured-supp-fee">0 VNĐ</span></div>
          </div>
        </div>

        <!-- Dòng 4..: Mỗi NĐBH bổ sung -->
        <div id="supp-insured-summaries" class="mb-3"></div>

        <!-- Dòng 5: Tổng -->
        <div id="summary-totals" class="border-t pt-3 mt-3 mb-3">
          <div class="font-semibold text-gray-800 mb-2">Tóm tắt tổng phí:</div>
          <div class="pl-4 text-sm">
            <div>Phí chính: <span id="summary-main-fee">0 VNĐ</span></div>
            <div>Phí đóng thêm: <span id="summary-extra-fee">0 VNĐ</span></div>
            <div>Phí sản phẩm bổ sung: <span id="summary-supp-fee">0 VNĐ</span></div>
            <div class="font-bold mt-2">Tổng cộng: <span id="summary-total" class="text-aia-red">0 VNĐ</span></div>
          </div>
        </div>

        <!-- Dòng 6-7: Kỳ đóng phí -->
        <div class="mb-4">
          <label for="payment-frequency" class="font-medium text-gray-700 block mb-1">Kỳ đóng phí</label>
          <select id="payment-frequency" class="form-select w-full" aria-label="Kỳ đóng phí">
            <option value="year" selected>Năm (mặc định)</option>
            <option value="half">Nửa năm</option>
            <option value="quarter">Quý</option>
          </select>
        </div>

        <!-- Breakdown theo kỳ (ẩn khi chọn Năm) -->
        <div id="frequency-breakdown" class="space-y-1 text-sm text-gray-700 mb-3 hidden" aria-live="polite">
          <div>Phí chính + đóng thêm (theo kỳ): <span id="freq-main-plus-extra">0 VNĐ</span></div>
          <div>Phí sản phẩm bổ sung (theo kỳ): <span id="freq-supp-total">0 VNĐ</span></div>
          <div class="font-semibold">Tổng (theo kỳ): <span id="freq-total-period" class="text-aia-red">0 VNĐ</span></div>
          <div>Tổng cộng đóng 1 năm (quy đổi): <span id="freq-total-year">0 VNĐ</span></div>
          <div>Chênh lệch so với đóng 1 năm: <span id="freq-diff">0 VNĐ</span></div>
        </div>

        <!-- Giữ các ID cũ để tương thích với logic.js -->
        <div class="mt-3">
          <div class="flex justify-between items-center py-2 border-b">
            <span class="text-gray-600">Phí sản phẩm chính (hiển thị tương thích):</span>
            <span id="main-premium-result" class="font-bold text-gray-900">0 VNĐ</span>
          </div>
          <div id="supplementary-premiums-results"></div>
          <div class="flex justify-between items-center pt-4 text-xl">
            <span class="font-semibold text-aia-red">Tổng phí năm đầu:</span>
            <span id="total-premium-result" class="font-extrabold text-aia-red">0 VNĐ</span>
          </div>
        </div>

      </div>

      <div class="mt-6 space-y-4">
        <div>
          <label for="target-age-input" class="font-medium text-gray-700 block mb-1">Minh họa phí đến năm (tuổi NĐBH chính)</label>
          <input type="number" id="target-age-input" class="form-input" placeholder="VD: 75" min="0" max="100">
        </div>
        <button id="view-summary-btn" class="w-full bg-aia-red text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition-colors" aria-controls="summary-modal">Xem Bảng Minh Họa Chi Tiết</button>
      </div>
      <div id="error-message" class="mt-4 text-center text-red-500 font-medium min-h-[1.25rem]" aria-live="assertive"></div>
    </div>
  </div>
</main>

<footer class="text-center text-gray-500 mt-12 py-4 border-t">
  Công cụ này chỉ mang tính chất tham khảo cá nhân, không phải là bảng minh họa chính thức của AIA. Quyền lợi và mức phí cụ thể sẽ được xác nhận trong hợp đồng do AIA phát hành. 
  Vui lòng liên hệ tư vấn viên AIA để được tư vấn chi tiết và nhận bảng minh họa chính thức
</footer>
</div>

<!-- Modal -->
<div id="summary-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50" role="dialog" aria-modal="true" aria-labelledby="summary-modal-title">
  <div class="bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] flex flex-col">
    <div class="p-4 border-b flex justify-between items-center sticky top-0 bg-white">
      <h2 id="summary-modal-title" class="text-2xl font-bold text-aia-red">Bảng Tóm Tắt Quyền Lợi và Phí</h2>
      <button id="close-summary-modal-btn" class="text-3xl font-light leading-none hover:text-red-600" aria-label="Đóng bảng tóm tắt">&times;</button>
    </div>
    <div id="summary-content-container" class="p-6 overflow-y-auto"></div>
    <!-- Miễn trừ cuối bảng (in đậm) -->
    <div class="p-6 border-t">
      <p class="font-bold text-gray-800">
        Công cụ này chỉ mang tính chất tham khảo cá nhân, không phải là bảng minh họa chính thức của AIA.
        Quyền lợi và mức phí cụ thể sẽ được xác nhận trong hợp đồng do AIA phát hành.
        Vui lòng liên hệ tư vấn viên AIA để được tư vấn chi tiết và nhận bảng minh họa chính thức.
      </p>
    </div>
  </div>
</div>

<!-- Giữ nguyên thứ tự module theo bản gốc của bạn -->
<script type="module" src="logic.js"></script>
<script type="module" src="data.js"></script>
</body>
</html>
